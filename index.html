<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wedding Invitation</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body class="locked">
  <!-- Sparkles overlay -->
  <div id="sparkles" aria-hidden="true"></div>

  <!-- Music -->
  <audio id="bgMusic" src="music.mp3" preload="auto" loop></audio>

  <!-- Sound toggle (shows after open) -->
  <button id="soundBtn" class="soundBtn" type="button" aria-label="Toggle sound" title="Sound">
    ğŸ”Š
  </button>

  <main class="page">

    <!-- ===== HERO / ENVELOPE STAGE ===== -->
    <section class="stage" id="stage">
      <div class="frame">

        <!-- Envelope (sealed/unsealed swap) -->
        <img
          id="envelopeImg"
          class="envelope"
          src="envelope.png"
          alt="Envelope"
          draggable="false"
        />

        <!-- Seal button (click area) -->
        <button
          id="sealBtn"
          class="sealBtn"
          type="button"
          aria-label="Open envelope"
        >
          OPEN
        </button>

        <!-- Card (slides up to cover envelope, then flip) -->
        <div id="flipContainer" class="flipContainer" aria-label="Invitation card (tap to flip)">
          <div id="flipCard" class="flipCard">
            <img class="cardFace cardFront" src="card1.png" alt="Card front" draggable="false" />
            <img class="cardFace cardBack"  src="card2.png" alt="Card back"  draggable="false" />
          </div>
          <div class="flipHint">Tap card to flip</div>
        </div>

      </div>
    </section>

    <!-- ===== DOA SECTION (scroll-based reveal) ===== -->
    <section class="section doa afterOpen" id="doaSection">
      <div class="doaInner">
        <div class="doaTextBox" id="doaText" aria-label="Doa text">
          <p class="line bold">ÙˆÙÙ…ÙÙ†Ù’ Ø¡ÙØ§ÙŠÙÙ€Ù°ØªÙÙ‡ÙÛ¦Ù“ Ø£ÙÙ†Ù’ Ø®ÙÙ„ÙÙ‚Ù Ù„ÙÙƒÙÙ… Ù…Ù‘ÙÙ†Ù’ Ø£ÙÙ†ÙÙØ³ÙÙƒÙÙ…Ù’ Ø£ÙØ²Ù’ÙˆÙÙ°Ø¬Ù‹Û­Ø§ Ù„Ù‘ÙØªÙØ³Ù’ÙƒÙÙ†ÙÙˆÙ“Ø§ÛŸ Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ ÙˆÙØ¬ÙØ¹ÙÙ„Ù Ø¨ÙÙŠÙ’Ù†ÙÙƒÙÙ… Ù…Ù‘ÙÙˆÙØ¯Ù‘ÙØ©Ù‹Û­ ÙˆÙØ±ÙØ­Ù’Ù…ÙØ©Ù‹ Ûš Ø¥ÙÙ†Ù‘Ù ÙÙÙ‰ Ø°ÙÙ°Ù„ÙÙƒÙ Ù„ÙÙ€Ù”ÙØ§ÙŠÙÙ€Ù°ØªÙÛ¢ Ù„Ù‘ÙÙ‚ÙÙˆÙ’Ù…ÙÛ¢ ÙŠÙØªÙÙÙÙƒÙ‘ÙØ±ÙÙˆÙ†Ù Ù¢Ù¡</p>
          <p class="line bold">(30:21) And of His signs is that He created for you from yourselves mates that you may find tranquility in them;</p>
          <p class="line bold">and He placed between you affection and mercy. Verily in that are signs for those who reflect</p>

          <p class="line bold">Û Ù‡ÙÙˆÙ Ù±Ù„Ù‘ÙØ°ÙÙ‰ Ø®ÙÙ„ÙÙ‚ÙÙƒÙÙ… Ù…Ù‘ÙÙ† Ù†Ù‘ÙÙÙ’Ø³ÙÛ¢ ÙˆÙÙ°Ø­ÙØ¯ÙØ©ÙÛ¢ ÙˆÙØ¬ÙØ¹ÙÙ„Ù Ù…ÙÙ†Ù’Ù‡ÙØ§ Ø²ÙÙˆÙ’Ø¬ÙÙ‡ÙØ§ Ù„ÙÙŠÙØ³Ù’ÙƒÙÙ†Ù Ø¥ÙÙ„ÙÙŠÙ’Ù‡ÙØ§ Û– ÙÙÙ„ÙÙ…Ù‘ÙØ§ ØªÙØºÙØ´Ù‘ÙÙ‰Ù°Ù‡ÙØ§ Ø­ÙÙ…ÙÙ„ÙØªÙ’ Ø­ÙÙ…Ù’Ù„Ù‹Ø§ Ø®ÙÙÙÙŠÙÙ‹Û­Ø§ ÙÙÙ…ÙØ±Ù‘ÙØªÙ’ Ø¨ÙÙ‡ÙÛ¦ Û– ÙÙÙ„ÙÙ…Ù‘ÙØ§Ù“ Ø£ÙØ«Ù’Ù‚ÙÙ„ÙØª Ø¯Ù‘ÙØ¹ÙÙˆÙØ§ Ù±Ù„Ù„Ù‘ÙÙ‡Ù Ø±ÙØ¨Ù‘ÙÙ‡ÙÙ…ÙØ§ Ù„ÙØ¦ÙÙ†Ù’ Ø¡ÙØ§ØªÙÙŠÙ’ØªÙÙ†ÙØ§ ØµÙÙ€Ù°Ù„ÙØ­Ù‹Û­Ø§ Ù„Ù‘ÙÙ†ÙÙƒÙÙˆÙ†ÙÙ†Ù‘Ù Ù…ÙÙ†Ù Ù±Ù„Ø´Ù‘ÙÙ€Ù°ÙƒÙØ±ÙÙŠÙ†Ù Ù¡Ù¨Ù©</p>
          <p class="line bold">(7:189)It is He who created you from one soul and created from it its mate that he might dwell in security with her.</p>
          <p class="line bold">And when he covers her, she carries a light burden and continues therein.</p>
          <p class="line bold">And when it becomes heavy, they both invoke Allah, their Lord, â€œIf You should give us a good [child], we will surely be among the grateful.</p>
        </div>
      </div>
    </section>

    <!-- ===== ACTIONS (Countdown + Map + RSVP) ===== -->
    <section class="section actions afterOpen" id="actionsSection">
      <div class="panel">
        <h2 class="panelTitle">Countdown</h2>

        <div class="countdown" id="countdown">
          <div class="cdItem"><span id="cdDays">0</span><small>Days</small></div>
          <div class="cdItem"><span id="cdHours">0</span><small>Hours</small></div>
          <div class="cdItem"><span id="cdMins">0</span><small>Mins</small></div>
          <div class="cdItem"><span id="cdSecs">0</span><small>Secs</small></div>
        </div>

        <!-- Event info under countdown -->
        <p class="eventInfo">
          Sabtu, 2 Mei 2026 â€¢ 11:30 AM â€“ 3:30 PM
        </p>

        <div class="btnRow">
          <a class="btn gold" href="https://maps.app.goo.gl/B8JHTKmf4dmdw7Ku7" target="_blank" rel="noopener">
            ğŸ“ Google Map
          </a>

          <a class="btn gold" href="https://docs.google.com/forms/d/e/1FAIpQLSfBWe5IBelfTU7LKJhVfb5zdgDtQ7D1xK-jmd0pqqEJ1QBq4A/viewform" target="_blank" rel="noopener">
            ğŸ“ RSVP
          </a>
        </div>
      </div>
    </section>

    <!-- ===== GALLERY (Swipe slider) ===== -->
    <section class="section gallery afterOpen" id="gallerySection">
      <div class="panel">
        <h2 class="panelTitle">Gallery</h2>

        <div class="galleryTrack" id="galleryTrack" aria-label="Swipe gallery">
          <div class="gallerySlide"><img src="gallery1.jpeg" alt="Gallery 1" /></div>
          <div class="gallerySlide"><img src="gallery2.jpeg" alt="Gallery 2" /></div>
          <div class="gallerySlide"><img src="gallery3.jpeg" alt="Gallery 3" /></div>
          <div class="gallerySlide"><img src="gallery4.jpeg" alt="Gallery 4" /></div>
        </div>

        <div class="dots" id="dots" aria-label="Gallery navigation">
          <button class="dot active" type="button" aria-label="Slide 1"></button>
          <button class="dot" type="button" aria-label="Slide 2"></button>
          <button class="dot" type="button" aria-label="Slide 3"></button>
          <button class="dot" type="button" aria-label="Slide 4"></button>
        </div>
      </div>
    </section>

    <footer class="footerSpace afterOpen"></footer>
  </main>

  <script>
    // ===== CONFIG =====
    const weddingDate = new Date("May 2, 2026 11:30:00").getTime();

    // ===== ELEMENTS =====
    const body = document.body;
    const sealBtn = document.getElementById("sealBtn");
    const envelopeImg = document.getElementById("envelopeImg");
    const flipContainer = document.getElementById("flipContainer");
    const flipCard = document.getElementById("flipCard");
    const sparkles = document.getElementById("sparkles");

    const doaSection = document.getElementById("doaSection");
    const doaText = document.getElementById("doaText");
    const doaLines = Array.from(doaText.querySelectorAll(".line"));

    const galleryTrack = document.getElementById("galleryTrack");
    const dotsWrap = document.getElementById("dots");
    const dots = Array.from(dotsWrap.querySelectorAll(".dot"));

    const bgMusic = document.getElementById("bgMusic");
    const soundBtn = document.getElementById("soundBtn");

    // ===== STATE =====
    let opened = false;

    // ===== HELPERS =====
    function lockScroll(lock) {
      if (lock) body.classList.add("locked");
      else body.classList.remove("locked");
    }

    function startSparkles() {
      sparkles.innerHTML = "";
      const count = 70;
      for (let i = 0; i < count; i++) {
        const s = document.createElement("span");
        s.className = "sparkle";
        s.style.left = Math.random() * 100 + "%";
        s.style.top = Math.random() * 100 + "%";
        s.style.animationDelay = (Math.random() * 2.5) + "s";
        s.style.animationDuration = (2 + Math.random() * 3) + "s";
        s.style.opacity = (0.35 + Math.random() * 0.65).toFixed(2);
        sparkles.appendChild(s);
      }
      sparkles.classList.add("on");
    }

    async function tryPlayMusic() {
      try {
        await bgMusic.play();
        soundBtn.classList.add("show");
        soundBtn.textContent = "ğŸ”Š";
      } catch (e) {
        // If browser blocks autoplay, user can tap sound button
        soundBtn.classList.add("show");
        soundBtn.textContent = "ğŸ”‡";
      }
    }

    function revealCardAndEnableFlip() {
      flipContainer.classList.add("show");
      setTimeout(() => {
        flipContainer.classList.add("ready");
        body.classList.add("opened");
        lockScroll(false);
      }, 900);
    }

    // ===== OPEN ENVELOPE FLOW =====
    sealBtn.addEventListener("click", () => {
      if (opened) return;
      opened = true;

      lockScroll(true);

      envelopeImg.src = "envelope_open.png";
      envelopeImg.classList.add("opened");

      sealBtn.classList.add("hide");

      startSparkles();
      tryPlayMusic();

      setTimeout(() => revealCardAndEnableFlip(), 450);
    });

    // ===== SOUND TOGGLE =====
    soundBtn.addEventListener("click", async () => {
      if (bgMusic.paused) {
        try { await bgMusic.play(); soundBtn.textContent = "ğŸ”Š"; }
        catch(e) { /* ignore */ }
      } else {
        bgMusic.pause();
        soundBtn.textContent = "ğŸ”‡";
      }
    });

    // ===== FLIP CARD (card1 <-> card2) =====
    flipContainer.addEventListener("click", () => {
      if (!flipContainer.classList.contains("ready")) return;
      flipCard.classList.toggle("flipped");
    });

    // ===== DOA REVEAL (scroll-based) =====
    function updateDoaByScroll() {
      if (!body.classList.contains("opened")) return;

      const rect = doaSection.getBoundingClientRect();
      const vh = window.innerHeight || 1;

      // progress from 0 -> 1 across the section
      const total = rect.height + vh * 0.2;
      const passed = (vh * 0.9) - rect.top;
      const progress = Math.max(0, Math.min(1, passed / total));

      const countToShow = Math.floor(progress * doaLines.length + 0.0001);
      doaLines.forEach((line, idx) => {
        if (idx < countToShow) line.classList.add("show");
      });
    }

    window.addEventListener("scroll", updateDoaByScroll, { passive: true });
    window.addEventListener("resize", updateDoaByScroll);

    // ===== COUNTDOWN =====
    function pad2(n) { return String(n).padStart(2, "0"); }

    function tickCountdown() {
      const now = Date.now();
      const dist = weddingDate - now;

      const days = Math.max(0, Math.floor(dist / (1000 * 60 * 60 * 24)));
      const hours = Math.max(0, Math.floor((dist % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)));
      const mins  = Math.max(0, Math.floor((dist % (1000 * 60 * 60)) / (1000 * 60)));
      const secs  = Math.max(0, Math.floor((dist % (1000 * 60)) / 1000));

      document.getElementById("cdDays").textContent = days;
      document.getElementById("cdHours").textContent = pad2(hours);
      document.getElementById("cdMins").textContent = pad2(mins);
      document.getElementById("cdSecs").textContent = pad2(secs);
    }
    tickCountdown();
    setInterval(tickCountdown, 1000);

    // ===== GALLERY DOTS SYNC =====
    function setActiveDot(idx) {
      dots.forEach((d, i) => d.classList.toggle("active", i === idx));
    }

    dots.forEach((dot, idx) => {
      dot.addEventListener("click", () => {
        const slideW = galleryTrack.clientWidth;
        galleryTrack.scrollTo({ left: slideW * idx, behavior: "smooth" });
        setActiveDot(idx);
      });
    });

    let scrollTimer = null;
    galleryTrack.addEventListener("scroll", () => {
      window.clearTimeout(scrollTimer);
      scrollTimer = window.setTimeout(() => {
        const slideW = galleryTrack.clientWidth;
        const idx = Math.round(galleryTrack.scrollLeft / slideW);
        setActiveDot(Math.max(0, Math.min(dots.length - 1, idx)));
      }, 80);
    });
  </script>
</body>
</html>
